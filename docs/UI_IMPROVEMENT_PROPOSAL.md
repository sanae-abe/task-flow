# ラベル管理画面 UI/UX 改善提案

## 概要

現在のラベル管理画面のユーザビリティと視覚デザインを改善し、より直感的で効率的な操作体験を提供するための提案書です。

## 現在のUIの問題点

### 1. 情報アーキテクチャの問題

#### 常時表示されるフォーム
- **問題**: 作成/編集フォームが常に上部に表示され、ラベル一覧の閲覧性を阻害
- **影響**: 500pxの固定高さのダイアログで、フォームが約40%のスペースを占有
- **ユーザー体験**: スクロールが必要になり、多数のラベルの管理が困難

#### 視覚的階層の不明確さ
- **問題**: フォームとリストが同じ重要度で表示
- **影響**: 主要アクション(閲覧)と副次アクション(作成/編集)の区別が不明確
- **ユーザー体験**: 何をすべきか判断に迷う

### 2. ユーザビリティの課題

#### ワークフローの混乱
```
現在の操作フロー:
1. 下部の「新規作成」ボタンをクリック
2. 視線を上部のフォームに移動
3. フォーム入力
4. 保存後、再度下部のリストを確認

問題点: 視線の移動が多く、操作が非効率
```

#### 状態管理の複雑さ
- `isCreating` と `editingLabel` の2つの状態で管理
- ユーザーが現在の状態を把握しにくい
- キャンセルボタンの表示/非表示が一貫性に欠ける

### 3. 視覚デザインの課題

#### 色の視認性
- ColorSelectorの色プレビューが32pxと小さい
- ラベルの実物とのイメージギャップが大きい
- 選択した色の実際の見た目が分かりにくい

#### アクションボタンの配置
- 編集・削除ボタンが各行の右端に常時表示
- 誤操作のリスクが高い
- 視覚的なノイズが多い

#### 空状態の活用不足
- 「ラベルがありません」の表示が消極的
- 新規作成への導線が弱い
- 初回利用時のガイダンスが不足

## 改善提案

### 1. レイアウトの改善

#### A案: モーダルベースの編集 (推奨)

**特徴**:
- 新規作成・編集時に専用ダイアログを表示
- メインダイアログはラベル一覧のみ表示
- クリーンで見やすいインターフェース

**メリット**:
- フォーカスの集中(編集作業に専念できる)
- スペース効率の大幅な向上
- バリデーションエラーの表示領域確保
- 将来的な機能拡張が容易

**デメリット**:
- ダイアログの入れ子構造
- モーダル表示のオーバーヘッド

**実装の複雑度**: ★★☆☆☆

#### B案: インラインエディティング

**特徴**:
- テーブル行をクリックでその場編集
- 編集中の行のみフォーム表示
- GitHub Issuesライクなインターフェース

**メリット**:
- コンテキストの切り替えなし
- 素早い編集が可能
- 直感的な操作フロー

**デメリット**:
- 複数フィールド追加時のUI複雑化
- バリデーションエラー表示の制約

**実装の複雑度**: ★★★☆☆

#### C案: サイドパネル編集

**特徴**:
- 右側にスライド式の編集パネル表示
- ラベル一覧と編集フォームが同時表示
- Figma/Slackライクなインターフェース

**メリット**:
- リアルタイムプレビュー
- 一覧を見ながら編集可能
- モダンなUX

**デメリット**:
- スペース効率が低い
- モバイル対応が困難
- 実装が複雑

**実装の複雑度**: ★★★★☆

### 推奨: A案 (モーダルベースの編集)

理由:
1. **シンプルな実装**: Primer Reactの既存コンポーネントで実現可能
2. **高いスペース効率**: ラベル一覧に専念できる
3. **拡張性**: 将来的な機能追加が容易
4. **一貫性**: 既存のダイアログパターンと整合

### 2. ビジュアルデザインの改善

#### テーブルレイアウト

```
┌─────────────────────────────────────────┐
│ ラベル         使用数        アクション  │
├─────────────────────────────────────────┤
│ [Bug] 赤         5件      [編集][削除]  │
│ [Feature] 青     3件      [編集][削除]  │
│ [Design] 紫      2件      [編集][削除]  │
└─────────────────────────────────────────┘
```

**改善点**:
- グリッドレイアウトで整列
- ヘッダーで情報の種類を明示
- 使用数を追加して有用性向上

#### カラーセレクターの改善

**現在**: 32px × 32px のボタン
**改善案**: 40px × 40px + リアルタイムプレビュー

```tsx
<Box sx={{ display: 'flex', gap: 3, alignItems: 'center' }}>
  <ColorSelector
    selectedColor={color}
    onColorSelect={setColor}
    buttonSize={40}
  />
  <Box sx={{ p: 2, bg: 'canvas.subtle', borderRadius: 2 }}>
    <Text sx={{ fontSize: 0, color: 'fg.muted' }}>プレビュー:</Text>
    <LabelChip label={{ name: 'サンプル', color }} />
  </Box>
</Box>
```

**効果**:
- 色の選択精度向上
- 実際の見た目を事前確認
- ユーザーの満足度向上

#### 空状態の改善

**現在**:
```
┌─────────────────────┐
│ ラベルがありません    │
└─────────────────────┘
```

**改善案**:
```
┌─────────────────────┐
│       [アイコン]      │
│                      │
│  ラベルがありません   │
│ ラベルを作成して      │
│ タスクを分類しましょう │
│                      │
│  [最初のラベルを作成] │
└─────────────────────┘
```

**改善点**:
- アイコンで視覚的に訴求
- 説明文で価値を伝達
- CTAボタンで行動を促進

### 3. インタラクションパターンの改善

#### ホバーアクション

**実装**:
```tsx
<Box
  sx={{
    '&:hover .label-actions': {
      opacity: 1
    }
  }}
>
  <LabelChip label={label} />
  <Box
    className="label-actions"
    sx={{
      opacity: 0,
      transition: 'opacity 0.2s ease'
    }}
  >
    <IconButton icon={PencilIcon} />
    <IconButton icon={TrashIcon} />
  </Box>
</Box>
```

**効果**:
- 視覚的なノイズの削減
- 意図的な操作の促進
- 誤操作の防止

#### 削除確認ダイアログ

**機能**:
- 削除前の確認ステップ
- 使用数の警告表示
- 取り消し不可の明示

**コンテンツ例**:
```
ラベル「Bug」を削除しますか?

⚠ このラベルは 5 件のタスクで使用されています。
  削除すると、これらのタスクからラベルが削除されます。

この操作は取り消せません。

[キャンセル] [削除]
```

#### キーボードナビゲーション

**サポート内容**:
- `Tab` / `Shift+Tab`: ラベル間の移動
- `Enter`: 編集モードへの切り替え
- `Delete`: 削除確認ダイアログの表示
- `Escape`: ダイアログのクローズ

**実装**:
```tsx
const handleKeyDown = (e: KeyboardEvent, label: Label) => {
  if (e.key === 'Enter') {
    openEditDialog(label);
  } else if (e.key === 'Delete') {
    openDeleteDialog(label);
  }
};
```

### 4. 追加機能の提案

#### ラベル使用数の表示

**実装**:
```tsx
const getLabelUsageCount = (labelId: string): number => {
  // TaskContextからタスクを取得
  const tasks = useTaskContext();
  return tasks.filter(task =>
    task.labels?.some(label => label.id === labelId)
  ).length;
};
```

**効果**:
- データの有用性向上
- 削除判断の支援
- 使用状況の可視化

#### ラベルのソート機能

**ソートオプション**:
- 名前 (A-Z)
- 使用数 (多い順)
- 作成日時 (新しい順)
- 色 (グループ化)

**UI**:
```tsx
<Select
  value={sortBy}
  onChange={setSortBy}
  options={[
    { value: 'name', label: '名前順' },
    { value: 'usage', label: '使用数順' },
    { value: 'created', label: '作成日順' },
    { value: 'color', label: '色順' }
  ]}
/>
```

#### ラベルの検索機能

**実装** (多数のラベルがある場合):
```tsx
<TextInput
  placeholder="ラベルを検索..."
  value={searchQuery}
  onChange={setSearchQuery}
  leadingVisual={SearchIcon}
/>
```

**フィルタリング**:
```tsx
const filteredLabels = labels.filter(label =>
  label.name.toLowerCase().includes(searchQuery.toLowerCase())
);
```

## 実装計画

### フェーズ1: 基本改善 (1-2日)
- [ ] モーダルベースの編集ダイアログ実装
- [ ] テーブルレイアウトへの変更
- [ ] 空状態の改善
- [ ] ホバーアクションの実装

### フェーズ2: UX強化 (1日)
- [ ] 削除確認ダイアログ
- [ ] カラーセレクターのプレビュー追加
- [ ] キーボードナビゲーション

### フェーズ3: 機能追加 (1-2日)
- [ ] ラベル使用数の表示
- [ ] ソート機能
- [ ] 検索機能 (オプション)

### 総工数見積もり: 3-5日

## 技術的考慮事項

### Primer React互換性
- すべての提案はPrimer Reactの既存コンポーネントで実装可能
- カスタムコンポーネントは最小限
- デザインシステムとの整合性を維持

### TypeScript型安全性
```typescript
interface LabelEditDialogProps {
  isOpen: boolean;
  onClose: () => void;
  label?: Label;
  onSave: (data: LabelFormData) => void;
}

interface LabelFormData {
  name: string;
  color: string;
}
```

### アクセシビリティ
- ARIA属性の適切な使用
- キーボードナビゲーション対応
- スクリーンリーダー対応
- カラーコントラスト確保

### パフォーマンス
- メモ化の活用 (`memo`, `useMemo`, `useCallback`)
- 仮想スクロール (多数のラベル時)
- 不要な再レンダリングの防止

## 期待される効果

### 定量的効果
- **編集完了までの時間**: 30%短縮 (5クリック → 3クリック)
- **視認可能なラベル数**: 2倍増加 (5件 → 10件)
- **誤操作の削減**: 50%減少 (ホバーアクション導入)

### 定性的効果
- より直感的な操作フロー
- 視覚的に整理された情報
- プロフェッショナルな印象
- ユーザー満足度の向上

## 参考デザイン

### GitHub Labels
- テーブルレイアウト
- ホバーアクション
- インライン編集

### Figma Layers
- ホバー時のアクション表示
- シンプルなアイコン操作
- キーボードショートカット

### Notion Properties
- モーダルベースの編集
- リアルタイムプレビュー
- 使いやすい色選択

## まとめ

本提案は、現在のラベル管理画面の主要な問題点を解決し、より効率的で使いやすいインターフェースを提供します。段階的な実装により、リスクを最小限に抑えながら、継続的な改善が可能です。

実装ファイル: `/src/components/SettingsDialog.improved.tsx`

---

作成日: 2025-10-09
最終更新: 2025-10-09
