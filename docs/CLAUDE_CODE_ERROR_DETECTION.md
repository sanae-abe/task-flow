# Claude Code ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ©ãƒ¼è‡ªå‹•æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ 

## ğŸ“‹ æ¦‚è¦

Claude CodeãŒ**è‡ªå¾‹çš„ã«ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã™ã‚‹**ãŸã‚ã®3å±¤ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

```
Layer 1: Playwright E2Eè‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆæœ€å„ªå…ˆãƒ»å®Œå…¨è‡ªå‹•ï¼‰
Layer 2: Vitestã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼ˆå˜ä½“ãƒ†ã‚¹ãƒˆæ™‚ï¼‰
Layer 3: Chrome Remote Debuggingï¼ˆæ‰‹å‹•ãƒ‡ãƒãƒƒã‚°è£œåŠ©ï¼‰
```

---

## ğŸ¯ Layer 1: Playwright E2Eè‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆæ¨å¥¨ï¼‰

### ç‰¹å¾´

- âœ… **Claude Codeã§å®Œå…¨è‡ªå‹•å®Ÿè¡Œå¯èƒ½**
- âœ… CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆå¯èƒ½
- âœ… ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»å‹•ç”»è¨˜éŒ²
- âœ… è¤‡æ•°ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œï¼ˆChromeã€Firefoxã€Safariï¼‰
- âœ… ãƒ¢ãƒã‚¤ãƒ«ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå¯¾å¿œ

### å®Ÿè¡Œæ–¹æ³•

```bash
# ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ©ãƒ¼æ¤œå‡ºå°‚ç”¨ãƒ†ã‚¹ãƒˆ
npm run test:browser-errors

# å…¨E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:e2e

# ç‰¹å®šãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿
npm run test:e2e:chromium
npm run test:e2e:firefox
npm run test:e2e:webkit

# UIãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ï¼‰
npm run test:e2e:ui

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
npm run test:e2e:debug
```

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

- **å ´æ‰€**: `e2e/browser-errors.spec.ts`
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**:
  - ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿
  - ã‚¿ã‚¹ã‚¯ä½œæˆãƒ•ãƒ­ãƒ¼
  - ã‚«ãƒ³ãƒãƒ³ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  - ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  - ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  - ãƒªãƒƒãƒãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆXSSå¯¾ç­–ç¢ºèªï¼‰
  - ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯æ¤œå‡ºï¼ˆé•·æ™‚é–“æ“ä½œï¼‰

### ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã®ä»•çµ„ã¿

```typescript
// è‡ªå‹•ã§ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡º
1. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ï¼ˆconsole.errorï¼‰
2. ãƒšãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼ï¼ˆJavaScriptä¾‹å¤–ï¼‰
3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆå¤±æ•—ï¼‰
4. è­¦å‘Šï¼ˆconsole.warnï¼‰

// ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã¯è‡ªå‹•ã§:
- ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜
- å‹•ç”»è¨˜éŒ²
- ãƒˆãƒ¬ãƒ¼ã‚¹æƒ…å ±ä¿å­˜
```

### å‡ºåŠ›ä¾‹

```
========== ã‚¨ãƒ©ãƒ¼ã‚µãƒãƒªãƒ¼ ==========
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼: 0
ãƒšãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼: 0
ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: 0
è­¦å‘Š: 2
===================================

âœ… ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚Œã°ã‚¨ãƒ©ãƒ¼ãªã—
âŒ ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚Œã°ã‚¨ãƒ©ãƒ¼ã‚ã‚Šï¼ˆè©³ç´°ã¯Playwrightãƒ¬ãƒãƒ¼ãƒˆã§ç¢ºèªï¼‰
```

---

## ğŸ§ª Layer 2: Vitestã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼

### ç‰¹å¾´

- âœ… å˜ä½“ãƒ†ã‚¹ãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆæ™‚ã®ã‚¨ãƒ©ãƒ¼æ¤œå‡º
- âœ… ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ã®è‡ªå‹•åé›†
- âœ… æœªå‡¦ç†ã‚¨ãƒ©ãƒ¼ãƒ»Promiseæ‹’å¦ã®ã‚­ãƒ£ãƒƒãƒ
- âœ… ãƒ†ã‚¹ãƒˆçµ‚äº†æ™‚ã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ

### å®Ÿè¡Œæ–¹æ³•

```bash
# å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚¨ãƒ©ãƒ¼æ¤œå‡ºå«ã‚€ï¼‰
npm run test:run

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãå®Ÿè¡Œ
npm run test:coverage

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
npm test
```

### ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã®ä»•çµ„ã¿

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/setupTests.ts`

```typescript
// è‡ªå‹•ã§ä»¥ä¸‹ã‚’æ¤œå‡º:
1. console.error() - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼
2. window.addEventListener('error') - æœªå‡¦ç†ã‚¨ãƒ©ãƒ¼
3. window.addEventListener('unhandledrejection') - Promiseæ‹’å¦

// ãƒ†ã‚¹ãƒˆçµ‚äº†æ™‚ã«è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›
```

### å‡ºåŠ›ä¾‹

```
========== åé›†ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ï¼ˆClaude Codeæ¤œå‡ºç”¨ï¼‰ ==========

[1] CONSOLE ã‚¨ãƒ©ãƒ¼
æ™‚åˆ»: 2025-11-09T12:34:56.789Z
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: Cannot read property 'foo' of undefined

[2] UNHANDLED ã‚¨ãƒ©ãƒ¼
æ™‚åˆ»: 2025-11-09T12:35:01.123Z
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ReferenceError: bar is not defined
ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:
  at MyComponent (src/components/MyComponent.tsx:42:10)

=========================================================
```

---

## ğŸ” Layer 3: Chrome Remote Debuggingï¼ˆæ‰‹å‹•è£œåŠ©ï¼‰

### ç‰¹å¾´

- âš ï¸ **æ‰‹å‹•å®Ÿè¡ŒãŒå¿…è¦**
- âœ… ãƒªã‚¢ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ã‚¨ãƒ©ãƒ¼ç›£è¦–
- âœ… JSONå½¢å¼ã§ã®å‡ºåŠ›ï¼ˆClaude Codeå‘ã‘ï¼‰
- âœ… ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šå¯èƒ½

### å®Ÿè¡Œæ–¹æ³•ï¼ˆæ‰‹å‹•ï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ—1: Chromeã‚’ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•

```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome \
  --remote-debugging-port=9222 \
  --user-data-dir=/tmp/chrome-debug
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•

```bash
# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§
npm start
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: èµ·å‹•ã—ãŸChromeã§ http://localhost:5173 ã‚’é–‹ã

#### ã‚¹ãƒ†ãƒƒãƒ—4: ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```bash
# æ¨™æº–ãƒ¢ãƒ¼ãƒ‰ï¼ˆç¶™ç¶šç›£è¦–ï¼‰
npm run monitor:browser

# 30ç§’é–“ç›£è¦–ã—ã¦è‡ªå‹•çµ‚äº†
npm run monitor:browser -- --timeout=30

# JSONå½¢å¼ã§å‡ºåŠ›ï¼ˆClaude Codeå‘ã‘ï¼‰
npm run monitor:browser -- --timeout=30 --json
```

### JSONå‡ºåŠ›å½¢å¼

```json
{
  "totalErrors": 3,
  "errors": [
    {
      "timestamp": "2025-11-09T12:34:56.789Z",
      "type": "console",
      "level": "error",
      "message": "Cannot read property 'foo' of undefined"
    },
    {
      "timestamp": "2025-11-09T12:35:01.123Z",
      "type": "exception",
      "message": "ReferenceError: bar is not defined",
      "stack": "  at MyComponent (src/components/MyComponent.tsx:42:10)",
      "url": "http://localhost:5173/src/components/MyComponent.tsx"
    }
  ],
  "summary": {
    "console": 1,
    "exception": 1,
    "network": 1
  }
}
```

### ä¿å­˜å ´æ‰€

- ãƒ†ã‚­ã‚¹ãƒˆãƒ­ã‚°: `logs/browser-errors.log`
- JSONãƒ­ã‚°: `logs/browser-errors.json`

---

## ğŸš€ Claude Codeç”¨çµ±åˆã‚³ãƒãƒ³ãƒ‰

### åŒ…æ‹¬çš„ã‚¨ãƒ©ãƒ¼æ¤œå‡º

```bash
# å‹ãƒã‚§ãƒƒã‚¯ + å˜ä½“ãƒ†ã‚¹ãƒˆ + E2Eãƒ†ã‚¹ãƒˆ
npm run detect-errors
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã‚’é †æ¬¡å®Ÿè¡Œ:

1. `npm run typecheck` - TypeScriptå‹ã‚¨ãƒ©ãƒ¼æ¤œå‡º
2. `npm run test:run` - Vitestå˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆLayer 2ï¼‰
3. `npm run test:browser-errors` - Playwright E2Eï¼ˆLayer 1ï¼‰

---

## ğŸ“Š ä½¿ã„åˆ†ã‘ã‚¬ã‚¤ãƒ‰

| ç”¨é€” | æ¨å¥¨ã‚³ãƒãƒ³ãƒ‰ | Layer |
|-----|------------|-------|
| **CI/CDè‡ªå‹•ãƒ†ã‚¹ãƒˆ** | `npm run detect-errors` | Layer 1 + 2 |
| **é–‹ç™ºä¸­ã®å®šæœŸãƒã‚§ãƒƒã‚¯** | `npm run test:browser-errors` | Layer 1 |
| **å˜ä½“ãƒ†ã‚¹ãƒˆæ™‚** | `npm run test:run` | Layer 2 |
| **æ‰‹å‹•ãƒ‡ãƒãƒƒã‚°** | `npm run monitor:browser` | Layer 3 |
| **ç‰¹å®šæ©Ÿèƒ½ã®è©³ç´°èª¿æŸ»** | `npm run test:e2e:ui` | Layer 1ï¼ˆUIï¼‰ |

---

## ğŸ¯ Claude Codeã§ã®æ´»ç”¨ä¾‹

### ä¾‹1: æ–°æ©Ÿèƒ½å®Ÿè£…å¾Œã®ã‚¨ãƒ©ãƒ¼ç¢ºèª

```bash
# Claude CodeãŒè‡ªå‹•ã§å®Ÿè¡Œå¯èƒ½
npm run detect-errors
```

â†’ **å‡ºåŠ›ã‚’è§£æã—ã¦ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°è‡ªå‹•ã§å ±å‘Š**

### ä¾‹2: ç‰¹å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¨ãƒ©ãƒ¼ç¢ºèª

```bash
# Playwrightã®UIãƒ¢ãƒ¼ãƒ‰ã§å¯¾è©±çš„ã«ãƒ†ã‚¹ãƒˆ
npm run test:e2e:ui
```

â†’ **Claude Codeã¯ãƒ†ã‚¹ãƒˆçµæœã‚’ç¢ºèªã—ã€ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ä¿®æ­£ææ¡ˆ**

### ä¾‹3: XSSè„†å¼±æ€§ã®ç¢ºèª

```bash
# ãƒªãƒƒãƒãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®XSSãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm run test:browser-errors
```

â†’ **è‡ªå‹•ã§XSSæ”»æ’ƒãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª**

### ä¾‹4: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã®æ¤œå‡º

```bash
# ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚’å«ã‚€E2Eå®Ÿè¡Œ
npm run test:e2e
```

â†’ **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç•°å¸¸å¢—åŠ ã‚’æ¤œå‡º**

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Playwrightãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

```bash
# Playwrightãƒ–ãƒ©ã‚¦ã‚¶ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npx playwright install

# ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm ci
```

### Chrome Remote DebuggingãŒæ¥ç¶šã§ããªã„

```bash
# Chromeãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
pkill -9 "Google Chrome"

# å†åº¦ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```

### E2Eãƒ†ã‚¹ãƒˆãŒé…ã„

```bash
# å˜ä¸€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã§å®Ÿè¡Œ
npm run test:e2e:chromium

# ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã§å®Ÿè¡Œ
npm run test:e2e
```

---

## ğŸ“ˆ ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

- [ ] **Sentryçµ±åˆ** - æœ¬ç•ªç’°å¢ƒã®ãƒªã‚¢ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ©ãƒ¼åé›†
- [ ] **Visual Regression Testing** - UIã®è¦–è¦šçš„ãªå¤‰æ›´æ¤œå‡º
- [ ] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–** - Core Web Vitalsè‡ªå‹•æ¸¬å®š
- [ ] **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ** - WCAGæº–æ‹ ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Playwrightå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://playwright.dev/)
- [Vitestå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vitest.dev/)
- [Chrome DevTools Protocol](https://chromedevtools.github.io/devtools-protocol/)

---

**æœ€çµ‚æ›´æ–°**: 2025-11-09
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
